var Rt=Object.defineProperty;var Pt=(e,t,r)=>t in e?Rt(e,t,{enumerable:true,configurable:true,writable:true,value:r}):e[t]=r;var z=(e,t,r)=>Pt(e,typeof t!="symbol"?t+"":t,r);var O="application/",J=O+"json",Se="charset=utf-8",w="Content-Type",P="undefined",k="object",x="string",T="function",ne="AbortError",_e="TimeoutError",Q="GET",He="HEAD",se="reject";var Me=10,G=(e,t)=>Object.prototype.hasOwnProperty.call(e,t);function oe(e){return e instanceof URLSearchParams}function y(e){return e!==null&&typeof e===k}function W(e){let t=G(e,"__proto__"),r=G(e,"constructor"),a=G(e,"prototype");if(!t&&!r&&!a)return e;let n={...e};return t&&delete n.__proto__,r&&delete n.constructor,a&&delete n.prototype,n}function Le(e){let t={};return Object.keys(e).sort().forEach(r=>t[r]=e[r]),t}function Ue(e,t){return t?e+(e.includes("?")?"&":"?")+t:e}function Ke(e,t){if(!t)return e;if(oe(t)){let l=t.toString();return Ue(e,l)}let r=[],a=encodeURIComponent,n=(l,u)=>{u=typeof u===T?u():u,u=u===null||u===void 0?"":u,r[r.length]=a(l)+"="+a(u);},s=(l,u,m=0)=>{if(m>=Me)return r;let c,p,g;if(l)if(Array.isArray(u))for(c=0,p=u.length;c<p;c++)s(l+"["+(typeof u[c]===k&&u[c]?c:"")+"]",u[c],m+1);else if(y(u))for(g in u)s(l+"["+g+"]",u[g],m+1);else n(l,u);else if(Array.isArray(u))for(c=0,p=u.length;c<p;c++)n(u[c].name,u[c].value);else for(g in u)s(g,u[g],m+1);return r},i=s("",t).join("&").replace(/%5B%5D/g,"[]");return Ue(e,i)}function je(e,t){if(!t||e.indexOf(":")===-1)return e;let r=t;return e.replace(/:([a-zA-Z0-9_]+)/g,(a,n)=>{if(G(r,n)){let s=r[n];if(s!=null)return encodeURIComponent(String(s))}return a})}function ie(e){return e.includes("://")}var h=()=>Date.now(),N=()=>{};function De(e){let t=typeof e;return e==null?false:t===x||t==="number"||t==="boolean"||Array.isArray(e)?true:typeof globalThis!==P&&typeof globalThis.Buffer!==P&&globalThis.Buffer.isBuffer(e)||e instanceof Date||oe(e)?false:!!(y(e)&&(Object.getPrototypeOf(e)===Object.prototype||typeof e.toJSON===T))}var S=e=>new Promise(t=>setTimeout(t,e,true));function Ee(e,t=0){return t>=Me?e:e&&y(e)&&typeof e.data!==P?Ee(e.data,t+1):e}function A(e){if(!e)return {};let t={};if(e instanceof Headers)e.forEach((r,a)=>{t[a.toLowerCase()]=r;});else for(let r in e)G(e,r)&&(t[r.toLowerCase()]=e[r]);return t}function ze(){return typeof window!==P&&typeof window.addEventListener===T}function ue(e,t){if(typeof DOMException!==P)return new DOMException(e,t);let r=new Error(e);return r.name=t,r}var Te=()=>{let e=typeof navigator!==P&&navigator.connection;return e&&["slow-2g","2g","3g"].includes(e.effectiveType)};async function C(e,t,...r){if(!e)return;let a=n=>n&&y(t)&&y(n)&&Object.assign(t,n);if(typeof e===T)a(await e(t,...r));else if(Array.isArray(e))for(let n of e)a(await n(t,...r));}var le=class extends Error{constructor(r,a,n){super(r);this.request=a;this.response=n;z(this,"status");z(this,"statusText");z(this,"config");z(this,"isCancelled");this.name="FetchError",this.status=n?n.status:0,this.statusText=n?n.statusText:"",this.config=a,this.isCancelled=false;}};var ce=class extends le{constructor(t,r,a){super(t,r,a),this.name="ResponseError";}};var me=600,Y=1e3,ht=me*Y,xe=Array(me).fill(0).map(()=>[]),B=new Map,fe=0,b=null,Je=([e,t])=>{B.delete(e);try{let r=t();r&&r instanceof Promise&&r.catch(N);}catch(r){}},I=(e,t,r)=>{if(_(e),r<Y||r>ht||r%Y!==0){B.set(e,[setTimeout(Je.bind(null,[e,t]),r)]);return}let a=r/Y,n=(fe+a)%me;xe[n].push([e,t]),B.set(e,n),b||(b=setInterval(()=>{fe=(fe+1)%me;let s=xe[fe];for(let o=0;o<s.length;o++)Je(s[o]);s.length=0,!B.size&&b&&(clearInterval(b),b=null);},Y));},_=e=>{let t=B.get(e);if(t!==void 0){if(Array.isArray(t))clearTimeout(t[0]);else {let r=xe[t],a=r.findIndex(([n])=>n===e);a!==-1&&r.splice(a,1);}B.delete(e),!B.size&&b&&(clearInterval(b),b=null);}};var H=new Map;function ke(e,t,r,a,n,s){if(!e)return new AbortController;let o=h(),i=H.get(e),l=null;if(i){let m=i[0],c=i[3];if(!c&&o-i[2]<a&&!m.signal.aborted)return m;c&&m.abort(ue("Aborted due to new request",ne)),_(e),l=i[4];}let u=new AbortController;return H.set(e,[u,s,o,n,l]),s&&I(e,()=>{Ge(e,ue(t+" aborted due to timeout",_e));},r),u}async function Ge(e,t=null){if(e){let r=H.get(e);r&&(t&&r[0].abort(t),pe(e));}}function pe(e){_(e),H.delete(e);}function We(e,t){let r=H.get(e);r&&(r[4]=t);}function be(e,t){if(!e)return null;let r=H.get(e);return r&&r[4]&&!r[3]&&h()-r[2]<t&&!r[0].signal.aborted?r[4]:null}function Z(e){let t=0;for(let r=0,a=e.length;r<a;r++){let n=e.charCodeAt(r);t=t*31+n|0;}return String(t)}var Ye=180*1e3,M=new Map,U=new Map,Ze=new Map;function gt(e,t){Ze.set(e,t),U.has(e)&&(Xe(e),we(e));}function Ve(e,t=true){let r=e==="focus"?5:6,a=h();M.forEach(n=>{if(!n[r])return;n[1]=a;let s=t?n[4]:n[0];s&&Promise.resolve(s(t)).catch(N);});}async function de(e,t=false){if(!e)return null;let r=M.get(e);if(r){r[1]=h();let a=t?r[4]:r[0];if(a)return await a(t)}return null}function Dt(e){Xe(e);let t=e==="focus"?5:6;M.forEach((r,a)=>{r[t]&&Et(a);});}function we(e){if(U.has(e))return;let t=Ve.bind(null,e,true),r=Ze.get(e);if(r){let a=r(t);U.set(e,a);return}ze()&&(window.addEventListener(e,t),U.set(e,()=>window.removeEventListener(e,t)));}function Xe(e){let t=U.get(e);t&&(t(),U.delete(e));}function $e(e,t,r,a,n,s,o){let i=M.get(e);i?(i[0]=t,i[1]=h(),i[2]=Ye,i[3]=a,i[4]=n,i[5]=s,i[6]=o):M.set(e,[t,h(),Ye,a,n,s,o]),s&&we("focus"),o&&we("online"),a&&I("s:"+e,de.bind(null,e,true),a*1e3);}function Et(e){M.delete(e),_("s:"+e);}var V=new Map;function Tt(e,t){let r=V.get(e);r||V.set(e,r=new Set),r.add(t);}function xt(e,t){let r=V.get(e);r&&(r.delete(t),r.size===0&&V.delete(e));}function L(e,t){let r=V.get(e);if(r)if(r.size===1){let a=r.values().next().value;a(t);}else r.forEach(a=>a(t));}function bt(e,t){return e?(Tt(e,t),()=>{xt(e,t);}):N}var Ae=(Te()?60:30)*1e3,X={strategy:se,timeout:Ae,headers:{Accept:J+", text/plain, */*","Accept-Encoding":"gzip, deflate, br"},retry:{delay:Ae/30,maxDelay:Ae,resetTimeout:true,backoff:1.5,retryOn:[408,409,425,429,500,502,503,504]}};function wt(e){let t=W(e);return K({},t,X)}function rt(){return {...X}}function Be(e,t){if(!t)return et(e,rt());let r=W(t),a=K(X,r);return et(e,a)}function et(e,t){var u;let r=t.method;r=r?r.toUpperCase():Q;let a;r!==Q&&r!==He&&(a=(u=t.body)!=null?u:t.data,a&&typeof a!==x&&De(a)&&(a=JSON.stringify(a))),At(t.headers,a);let n=t.withCredentials?"include":t.credentials,s=je(e,t.urlPathParams),o=Ke(s,t.params),l=ie(e)?"":t.baseURL||t.apiUrl||"";return t.url=l+o,t.method=r,t.credentials=n,t.body=a,t}function At(e,t){if(!e||!t||t instanceof FormData||typeof Blob!==P&&t instanceof Blob||typeof File!==P&&t instanceof File||typeof ReadableStream!==P&&t instanceof ReadableStream)return;let r;if(oe(t))r=O+"x-www-form-urlencoded";else if(t instanceof ArrayBuffer||ArrayBuffer.isView(t))r=O+"octet-stream";else if(De(t))r=J+";"+Se;else return;e instanceof Headers?e.has(w)||e.set(w,r):y(e)&&!Array.isArray(e)&&!e[w]&&(e[w]=r);}function K(e,t,r={}){return Object.assign(r,e,t),tt("retry",e,t,r),tt("headers",e,t,r),Ce("onRequest",e,t,r),Ce("onResponse",e,t,r),Ce("onError",e,t,r),r}function Ce(e,t,r,a){let n=t[e],s=r[e];if(!n&&!s)return;if(!n){a[e]=s;return}if(!s){a[e]=n;return}let o=Array.isArray(n)?n:[n],i=Array.isArray(s)?s:[s];a[e]=e==="onResponse"?i.concat(o):o.concat(i);}function tt(e,t,r,a){if(r[e]){let n=t[e],s=r[e];if(e==="headers"&&(n instanceof Headers||s instanceof Headers)){let o=A(n),i=A(s);a[e]={...o,...i};}else a[e]={...n,...s};}}var Re=new Map,q="|",Ie=64,at=/[^\w\-_|/:@.?=&~%#]/g,nt=/[^\w\-_|/:@.?=&~%#]/,Ct=new Set(["accept","accept-language","accept-encoding","authorization","content-type","referer","origin","user-agent","cookie","x-api-key","x-requested-with","x-client-id","x-tenant-id","x-user-id","x-app-version","x-feature-flag","x-device-id","x-platform","x-session-id","x-locale"]);function $(e,t=true){let r=e.cacheKey;if(r&&t)return typeof r===x?r:r(e);let{url:a="",method:n=Q,headers:s=null,body:o=null,credentials:i="same-origin"}=e,l="";if(s){let c;s instanceof Headers?c=A(s):c=s;let p=Object.keys(c),g=p.length;g>1&&p.sort();let f="";for(let E=0;E<g;++E)Ct.has(p[E].toLowerCase())&&(f+=p[E]+":"+c[p[E]]+";");l=Z(f);}if(n===Q){let c=n+q+a+q+i+q+l;return nt.test(c)?c.replace(at,""):c}let u="";if(o)if(typeof o===x)u=o.length<Ie?o:Z(o);else if(o instanceof FormData)o.forEach((c,p)=>{u+=p+"="+c+"&";}),u.length>Ie&&(u=Z(u));else if(typeof Blob!==P&&o instanceof Blob||typeof File!==P&&o instanceof File)u="BF"+o.size+o.type;else if(o instanceof ArrayBuffer||ArrayBuffer.isView(o))u="AB"+o.byteLength;else {let c=y(o)?JSON.stringify(Le(o)):String(o);u=c.length>Ie?Z(c):c;}let m=n+q+a+q+i+q+l+q+u;return nt.test(m)?m.replace(at,""):m}function st(e){return e.expiry?h()>e.expiry:false}function Pe(e){return Re.get(e)}function he(e,t,r,a){if(r===0){ye(e);return}let n=h(),s=r?r*1e3:0,o=a?a*1e3:0;Re.set(e,{data:t,time:n,stale:o>0?n+o:void 0,expiry:r===-1?void 0:n+s}),s>0&&I("c:"+e,()=>{ye(e,true);},s);}function ye(e,t=false){if(t){let r=Pe(e);if(!r||!st(r))return}Re.delete(e);}async function qe(e,t,r){if(!e)return null;let a=Pe(e);if(!a)return null;let n=y(t)?W(t):t,s={...a.data,data:n},o={...a,data:s};return Re.set(e,o),L(e,s),r&&r.refetch?await de(e):null}function ee(e,t,r){if(!e||t===void 0||t===null)return null;let a=r.cacheBuster||X.cacheBuster;if(a&&a(r)||r.cache&&r.cache==="reload")return null;let n=Pe(e);return n?st(n)?(ye(e),null):n.data:null}function Fe(e,t,r=false){let a=t.cacheKey;if(a){let n=t.cacheTime,s=t.skipCache;n&&(!r||t.cacheErrors)&&!(s&&s(e,t))&&he(a,e,n,t.staleTime),L(a,e),pe(a);let o=t._prevKey;o&&pe(o);}}async function ot(e){var n;if(!e)return null;let t=(n=e.headers)==null?void 0:n.get(w);t?t=t.toLowerCase().trim():t="";let r=t.split(";",1)[0],a;try{if(r.includes(J)||r.includes("+json"))a=await e.json();else if((r.includes("multipart/form-data")||r.includes(O+"x-www-form-urlencoded"))&&typeof e.formData===T)a=await e.formData();else if(/^(image|video|audio)\/|octet-stream|pdf|zip/.test(r))a=await e.arrayBuffer();else if(a=await e.text(),typeof a===x){let s=a.trim();if(s.startsWith("{")&&s.endsWith("}")||s.startsWith("[")&&s.endsWith("]"))try{a=JSON.parse(s);}catch(o){}}}catch(s){a=null;}return a}var ve=(e,t,r=null)=>{let a=t.defaultResponse,n=t.cacheKey,s=qe.bind(null,n);if(!e)return {ok:false,error:r,data:a!=null?a:null,headers:null,config:t,mutate:s,isFetching:false,isSuccess:false,isError:true};let o=typeof Response===T&&e instanceof Response,i=e.data;a!==void 0&&(i==null||typeof i===k&&Object.keys(i).length===0)&&(e.data=i=a),t.flattenResponse&&(e.data=i=Ee(i)),t.select&&(e.data=i=t.select(i));let l=A(e.headers);return o?{body:e.body,bodyUsed:e.bodyUsed,ok:e.ok,redirected:e.redirected,type:e.type,url:e.url,status:e.status,statusText:e.statusText,blob:()=>Promise.resolve(i instanceof ArrayBuffer?new Blob([i]):new Blob),json:()=>Promise.resolve(i),text:()=>Promise.resolve(i),clone:()=>e.clone(),arrayBuffer:()=>Promise.resolve(i instanceof ArrayBuffer?i:new ArrayBuffer(0)),formData:()=>Promise.resolve(i instanceof FormData?i:new FormData),bytes:()=>Promise.resolve(new Uint8Array(i instanceof ArrayBuffer?i:new ArrayBuffer(0))),error:r,data:i,headers:l,config:t,mutate:s,isFetching:false,isSuccess:e.ok&&!r,isError:!!r}:(y(e)&&(e.error=r,e.headers=l,e.isFetching=false,e.mutate=s,e.isSuccess=e.ok&&!r,e.isError=!!r),e)};function it(e){let t=Date.parse(e)-h();return isNaN(t)?null:Math.max(0,Math.floor(t))}function Bt(e){if(!e)return null;let t=e.headers||{},r=t["retry-after"];if(r){let o=Number(r);if(!isNaN(o)&&o>=0)return o*1e3;let i=it(r);if(i!==null)return i}let a="ratelimit-reset",n=t[a+"-after"]||t["x-"+a+"-after"];if(n){let o=Number(n);if(!isNaN(o))return o*1e3}let s=t[a+"-at"]||t["x-"+a+"-at"];return s?it(s):null}async function ut(e,t){let{retries:r=0,delay:a=0,backoff:n=1,maxDelay:s,retryOn:o=[],shouldRetry:i}=t,l=0,u=a,m=r>0?r:0,c;for(;l<=m;){if(l>0&&c){let f=c.config,E=f.onRetry;E&&(await C(E,c,l),f._isAutoKey&&(f._prevKey=f.cacheKey,f.cacheKey=$(f,false)));}c=await e(l>0,l);let p=c.error;if(!p){if(i&&l<m&&await i(c,l)){await S(u),u*=n||1,u=Math.min(u,s||u),l++;continue}break}if(await It(c,l,m,i,o))break;if(p.status===429||p.status===503){let f=Bt(c);f!==null&&(u=f);}await S(u),u*=n||1,u=Math.min(u,s||u),l++;}return c}async function It(e,t,r,a,n=[]){var s,o;if(t===r)return  true;if(a){let i=await a(e,t);if(i!==null)return !i}return !(n||[]).includes((o=(s=e.error)==null?void 0:s.status)!=null?o:0)}async function lt(e,t,r,a=0,n=0){if(!t)return e();let s=0,o;for(;(a===0||s<a)&&(n>0&&await S(n),o=await e(),s++,!(a>0&&s>=a||!t||r&&r(o,s)));)await S(t);return o}async function ct(e,t,r){var i;let a=await t(e),n=a.error;if(!n)return Fe(a,r),a;r.onError&&await C(r.onError,n);let s=n.isCancelled;if(!s&&((i=r.logger)!=null&&i.warn)&&r.logger.warn("FETCH ERROR",n),Fe(a,r,true),!s||r.rejectCancelled){let l=r.strategy;if(l===se)return Promise.reject(n);l==="silent"&&await new Promise(()=>null);}return a}function ft(e,t,r){e.status=e.status||(t==null?void 0:t.status)||0,e.statusText=e.statusText||(t==null?void 0:t.statusText)||"",e.config=e.request=r,e.response=t,e.isCancelled=e.name===ne;}var Oe=Object.freeze({isFetching:true});async function ge(e,t=null){if(t&&typeof t.cacheKey=="string"){let R=ee(t.cacheKey,t.cacheTime,t);if(R)return R}let r=Be(e,t),{timeout:a,cancellable:n,cacheKey:s,dedupeTime:o,cacheTime:i,staleTime:l,refetchOnFocus:u,refetchOnReconnect:m,pollingInterval:c=0}=r,p=i!==void 0||l!==void 0,g=!!(s||a||o||p||n||u||m),f=null;if(g&&(f=$(r)),f&&p){let R=ee(f,i,r);if(R)return R}if(f&&o){let R=be(f,o);if(R)return R}let E=r.retry||{},{retries:mt=0,resetTimeout:pt}=E,Qe=async(R=false,re=0)=>{re||(f&&!R&&(l?ee(f,i,r)||(he(f,Oe,i,l),L(f,Oe)):L(f,Oe)),r.cacheKey=f);let F=r.url,yt=ke(f,F,a,o||0,!!n,!!(a&&(!re||pt))),D=r;D.signal=yt.signal;let ae,d=null;try{r.onRequest&&(f&&o&&!re&&await null,await C(r.onRequest,D));let v=r.fetcher;if(d=v?await v(F,D):await fetch(F,D),y(d)&&(typeof Response===T&&d instanceof Response?d.data=D.parser?await D.parser(d):await ot(d):v&&("data"in d&&"body"in d||(d={data:d})),d.config=D,d.ok!==void 0&&!d.ok))throw new ce(D.method+" to "+F+" failed! Status: "+(d.status||null),D,d);ae=ve(d,D);let j=r.onResponse;j&&await C(j,ae);}catch(v){let j=v;ft(j,d,D),ae=ve(d,D,j);}return ae},dt=mt>0?(R=false)=>ut((re,F)=>Qe(R,F),E):Qe,te=(R=false)=>ct(R,dt,r),Ne=c?lt(te,c,r.shouldStopPolling,r.maxPollingAttempts,r.pollingDelay):te();return f&&(o&&We(f,Ne),(l||u||m)&&$e(f,te,void 0,l,te,!!u,!!m)),Ne}function qt(e){let t=e.endpoints;function r(n){return console.error("Add "+n+" to 'endpoints'."),Promise.resolve(null)}let a={config:e,endpoints:t,async request(n,s={}){let o=t[n],i=o||{url:String(n)},l=i.url;if(l.startsWith("//"))throw new Error("Protocol-relative URLs not allowed.");let u=ie(l)?(o==null?void 0:o.url)===l?K(i,s):s:K(K(e,i),s);return ge(l,u)}};return new Proxy(a,{get(n,s){return s in a?a[s]:t[s]?a.request.bind(null,s):r.bind(null,s)}})}
export{Ge as abortRequest,I as addTimeout,Be as buildConfig,ue as createAbortError,qt as createApiFetcher,ye as deleteCache,ge as fetchf,ge as fetchff,$ as generateCacheKey,Pe as getCache,ee as getCachedResponse,rt as getDefaultConfig,be as getInFlightPromise,Te as isSlowConnection,qe as mutate,Dt as removeRevalidators,de as revalidate,Ve as revalidateAll,he as setCache,wt as setDefaultConfig,gt as setEventProvider,bt as subscribe};//# sourceMappingURL=index.mjs.map
//# sourceMappingURL=index.mjs.map